# 大前端监控最佳实践



## 前端变化给监控带来的改变

* SPA模式下首屏如何计算？
* 跨端开发给监控带来的挑战？
* 传统的监控模式是否适用于新技术？比如 PV 统计
* 前端监控的上报模式在 Nodejs 端是否合理？

* 阿里云 ARMS前端监控系统


## 导致 PV 下降和原因和解决方法

* 原因：页面路由替代了请求新的页面
* 解决方法：
	* 哈希路由：监听 `hash change` 变化上报 PV
	* History 路由：hack `pushState & replaceState`

* 扩展思考
	* 下拉刷新
	* 滚屏分页加载
	* 未关闭的浏览器 Tab 几小时后再次浏览
	* 查找信息，浏览器 Tab 之前的切换
	* 元素是否可见，每个元素对页面的影响 -> 权重


## SPA 模式下的 PV 统计问题？

* FMP = 主要内容可见时间
	* SPA 页面，用户感官指标 FMP
	* first meaning paint


* 技术升级，体验升级，PV下降
	* SPA 导致 W3C标准失去原来的意义


## 监控最佳实践

1. 主动监控
	* 配置警告规则
	* 主动警告
	* 错误信息聚类
	* 解决后继续监控

2. 慢会话追踪
	* Chrome 加载性能分析

3. 搜索报错明细
4. 出错行为还原


## 参考资料

* [前端监控实践-FMP的智能获取算法](https://www.codercto.com/a/40349.html)